
server {
        listen 80 ;
        # listen 8000 ;
        # listen 8001 ;
        # listen [::]:80 default_server ipv6only=on;

        root /srv/www/dev.londonplay.com;
        # index index.html index.htm;

        # Make site accessible from http://localhost/
        server_name dev.londonplay.com;

        # location  /api { 
        #     proxy_pass http://dev.londonplay.com:8011;
        #     # proxy_set_header Host $host;

        # }
        location  /api { 
            # proxy_set_header Upgrade $http_upgrade;
            #     proxy_set_header Connection "upgrade";
            rewrite /api/(.*) /$1 break;
            proxy_pass http://dev.londonplay.com:8011/;
            proxy_redirect     off;
            proxy_set_header Host $host;


            # rewrite  ^/Shep.ElicenseWeb/(.*)  /$1 break;

            break;

        }


        location /assets/(.*) {
            #empty to prevent redirect madness
            break;
        }

        location ~ assets/ {

                rewrite /assets/(.*)$ http://dev.londonplay.com:8000/assets/$1 last;


                break;

        }

        location / {
                proxy_set_header Upgrade $http_upgrade;
                proxy_set_header Connection "upgrade";
                proxy_http_version 1.1;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_set_header Host $host;
                # proxy_pass http://socket_nodes;


    
                # First attempt to serve request as file, then
                # as directory, then fall back to displaying a 404.
                proxy_pass http://dev.londonplay.com:8000/;


                break;
        }




        access_log /srv/log/dev.londonplay.com/access.log;
        error_log /srv/log/dev.londonplay.com/error.log;

}